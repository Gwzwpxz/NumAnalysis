function [Q, R] = hhqr(A)
% Numerical Analysis Review. Chapter 1 hhqr
% Gwz, Shanghai University of Finance and Economics

[m, n] = size(A);
Q = eye(m);

if m > n
    error("More colu


for i = 1 : m - 1

    [v, beta] = hh(A(i : end, i));
    H = eye(m - i + 1) - beta * (v * v');
    A(i : end, i : end) = H * A(i : end, i : end);
    Q = Q * blkdiag(eye(i - 1), H);
    
end % End for 

R = triu(A);
   
end % End function
